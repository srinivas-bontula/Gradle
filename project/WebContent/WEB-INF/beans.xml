<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
	xmlns:context="http://www.springframework.org/schema/context"
	xmlns:jaxws="http://cxf.apache.org/jaxws"
	xmlns:cxf="http://cxf.apache.org/core"
	xmlns:mongo="http://www.springframework.org/schema/data/mongo"
	xmlns:jaxrs="http://cxf.apache.org/jaxrs"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
	http://www.springframework.org/schema/beans/spring-beans.xsd
 	http://cxf.apache.org/core 
 	http://cxf.apache.org/schemas/core.xsd
 	http://www.springframework.org/schema/data/mongo
    http://www.springframework.org/schema/data/mongo/spring-mongo-1.0.xsd
 	http://cxf.apache.org/jaxrs
 	http://cxf.apache.org/schemas/jaxrs.xsd
 	http://cxf.apache.org/jaxws
 	http://cxf.apache.org/schemas/jaxws.xsd
 	http://www.springframework.org/schema/context
 	http://www.springframework.org/schema/context/spring-context-4.1.xsd">

	<import resource="classpath:META-INF/cxf/cxf.xml" />
	<context:component-scan base-package="com.saba.*,in.amitv.*" />

	<bean id="AppContextAware" class="in.amitv.spring.AppContextAware"/>
	<bean id="logInbound" class="com.saba.taxpro.TaxRequestInterceptor"/>
	<bean id="logOutbound" class="com.saba.taxpro.TaxResponseInterceptor"/>
	<bean id="faultOutbound" class="com.saba.taxpro.TaxFaultOutInterceptor"/>
	

	<jaxrs:server id="taxService" address="/taxservices">
		<jaxrs:providers>
			<bean class="org.codehaus.jackson.jaxrs.JacksonJsonProvider" />
		</jaxrs:providers>
		<jaxrs:serviceBeans>
			<ref bean="proTaxService" />
		</jaxrs:serviceBeans>
		<jaxrs:extensionMappings>
			<entry key="json" value="application/json" />
		</jaxrs:extensionMappings>
		<jaxrs:inInterceptors>
     		<ref bean="logInbound"/>
 		</jaxrs:inInterceptors>
 		<jaxrs:outInterceptors>
    		<ref bean="logOutbound"/>
 		</jaxrs:outInterceptors>		
 		<jaxrs:outFaultInterceptors>
 			<ref bean="faultOutbound"/>
 		</jaxrs:outFaultInterceptors>
	</jaxrs:server>

	<jaxrs:server id="mmService" address="/mmservices">
		<jaxrs:providers>
			<bean class="org.codehaus.jackson.jaxrs.JacksonJsonProvider" />
		</jaxrs:providers>
		<jaxrs:serviceBeans>
			<ref bean="mongoManService" />
		</jaxrs:serviceBeans>
		<jaxrs:extensionMappings>
			<entry key="json" value="application/json" />
		</jaxrs:extensionMappings>
	</jaxrs:server>

	<jaxrs:server id="taxrecservices" address="/taxrecservices">
		<jaxrs:providers>
			<bean class="org.codehaus.jackson.jaxrs.JacksonJsonProvider" />
		</jaxrs:providers>
		<jaxrs:serviceBeans>
			<ref bean="taxRecService" />
		</jaxrs:serviceBeans>
		<jaxrs:extensionMappings>
			<entry key="json" value="application/json" />
		</jaxrs:extensionMappings>
	</jaxrs:server>

    <bean id="proTaxService" class="com.saba.taxpro.ProTaxServiceImpl"/>
    <bean id="mongoManService" class="in.amitv.mongowork.service.MongoManServiceImpl"/>
    <bean id="taxRecService" class="in.amitv.mongowork.service.TaxRecServiceImpl"/>
    <bean id="taxHelper" class="com.saba.taxpro.ProTaxHelper"/>
    
    <!-- Start of Mongo beans -->
    <!-- context:property-placeholder 
    	location="classpath:/in/amitv/mongowork/config/mongo.properties"/>
    
    <mongo:mongo 
    	host="${mongo.host}" 
    	port="${mongo.port}"/>
    
    <mongo:db-factory 
    	id="mongoDbFactory" 
    	dbname="${mongo.db.name}" 
    	mongo-ref="mongo"/-->

	<bean 
		id="mongoTemplate" 
		class="org.springframework.data.mongodb.core.MongoTemplate">
  		<constructor-arg 
  			name="mongoDbFactory" 
  			ref="mongoDbFactory"/>
	</bean>
	
	<mongo:repositories base-package="in.amitv.mongowork.repository" />
	
    <!-- End of Mongo beans -->
    
</beans>